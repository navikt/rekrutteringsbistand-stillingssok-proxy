apiVersion: "nais.io/v1alpha1"
kind: "Application"
metadata:
  name: rekrutteringsbistand-stillingssok-proxy
  namespace: toi
  labels:
    team: toi
spec:
  image: {{image}}
  port: 8300
  ingresses:
  {{#each ingress as |url|}}
      - {{url}}
  {{/each}}
  liveness:
    path: /internal/isAlive
  readiness:
    path: /internal/isReady
  replicas:
    min: {{ min_replicas }}
    max: {{ max_replicas }}
  resources:
    requests:
      cpu: {{ requested_cpu }}
      memory: 512Mi
  azure:
    application:
      enabled: true
      allowAllUsers: false
      claims:
        extra:
          - NAVident
        groups:
          - id: "ea34edea-1e80-4759-a1d2-fbe696cf1709"   # adGruppeModiaGenerellTilgang
          - id: "66b70a6a-3d05-47b3-8b5a-47c681dcd1d5"   # adGruppeJobbs√∏kerrettet
          - id: "46c8e3b2-0469-4740-983f-d8cd2b6e4fee"   # adGruppeArbeidsgiverrettet
          - id: "41080368-439f-4128-858a-afbef876431e"   # adGruppeUtvikler
  accessPolicy:
    inbound:
      rules:
        - application: foresporsel-om-deling-av-cv-api
          namespace: arbeidsgiver-inkludering
          cluster: {{fss-cluster}}
        - application: rekrutteringsbistand-stillingssok
        - application: rekrutteringsbistand-container
        - application: rekrutteringsbistand
  openSearch:
    access: read
    instance: rekrutteringsbistand-stilling
